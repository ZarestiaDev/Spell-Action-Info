<?xml version="1.0" encoding="iso-8859-1"?>

<root>
	<windowclass name="power_item_header" merge="join">
		<sheetdata>
		<!-- Zarestia adding invsible string to update the casting time live -->
			<invis_string_action name="updatecasting" source="castingtime" />
			<invis_string_additional name="updatecomponents" source="components" />
			<invis_string_additional name="updaterange" source="range" />

		<!-- Zarestia adding label to display the casting time -->
			<label name="action_info" insertbefore="group">
				<script file="campaign/scripts/show_action_info.lua" />
				<anchored width="85">
					<top offset="2" />
					<left parent="name" anchor="right" offset="10" />
				</anchored>
			</label>

		<!-- Zarestia adding label to display the components -->
			<label name="additional_info" insertbefore="group">
				<script file="campaign/scripts/show_additional_info.lua" />
				<anchored width="65">
					<top offset="2" />
					<left parent="action_info" anchor="right" />
				</anchored>
			</label>

		<!-- Zarestia editing ActionsMini -->
			<windowlist name="actionsmini">
				<anchored>
					<top offset="2" />
					<left parent="additional_info" anchor="right" relation="relative" offset="4" />
					<right />
				</anchored>
			</windowlist>
		</sheetdata>
	</windowclass>

	<!-- Zarestia adding merge for the display change -->
	<windowclass name="power_item" merge="join">
		<script file="campaign/scripts/power_item.lua" />
		<sheetdata>
			<genericcontrol name="spacer" insertbefore="activatedetail">
				<anchored to="rightanchor" height="20" width="20">
					<top />
					<right anchor="left" relation="relative" offset="0" />
				</anchored>
				<script>
					function onInit()
						local node = window.getDatabaseNode();
						DB.addHandler(DB.getPath(node, "actions"), "onChildAdded", update);
						DB.addHandler(DB.getPath(node, "actions"), "onChildDeleted", update);

						local bShow = (DB.getChildCount(window.getDatabaseNode(), "actions") == 0);
						setVisible(bShow);
					end

					function onClose()
						local node = window.getDatabaseNode();
						DB.removeHandler(DB.getPath(node, "actions"), "onChildAdded", update);
						DB.removeHandler(DB.getPath(node, "actions"), "onChildDeleted", update);
					end

					function update()
						if DB.getChildCount(window.getDatabaseNode(), "actions") == 0 then
							setVisible(true);
						else
							setVisible(false);
						end
					end
				</script>
			</genericcontrol>
		</sheetdata>
	</windowclass>
</root>
